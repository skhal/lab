# Copyright 2025 Samvel Khalatyan. All rights reserved.
#
# Use of this source code is governed by a BSD-style
# license that can be found in the LICENSE file.

name: Interview Questions CI

on:
  push:
    branches: ["main"]
    paths: ['iq/**']

jobs:
  bootstrap:
    uses: ./.github/workflows/ci_analyze.yml

  ci-go:
    needs: bootstrap
    # include cc_changes to ensure mixing Go and cc code is fine in the package.
    if: |
      needs.bootstrap.outputs.go_changes == 'true' ||
        needs.bootstrap.outputs.cc_changes == 'true'
    strategy:
      matrix:
        go-version: ['1.25.x']
    uses: ./.github/workflows/ci_go.yml
    with:
      package: ./iq
      go-version: ${{ matrix.go-version }}

  ci-cc:
    needs: bootstrap
    if: |
      needs.bootstrap.outputs.bzl_changes == 'true'
        || needs.bootstrap.outputs.cc_changes == 'true'
    strategy:
      matrix:
        llvm-version: [21]
    uses: ./.github/workflows/ci_cc_bazel.yml
    with:
      llvm-version: ${{ matrix.llvm-version }}
      package: //iq
