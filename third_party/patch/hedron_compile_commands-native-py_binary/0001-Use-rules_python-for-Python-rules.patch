From d60bc72aa31ec7aa76d3f5e9b675385c5219309a Mon Sep 17 00:00:00 2001
From: Samvel Khalatyan <sn.khalatyan@gmail.com>
Date: Thu, 29 Jan 2026 16:05:49 -0600
Subject: [PATCH 1/1] Use rules_python for Python rules

Bazel 9.0.0 uses modules for all rules:
https://blog.bazel.build/2026/01/20/bazel-9.html
---
 BUILD                        | 1 +
 MODULE.bazel                 | 3 +++
 refresh_compile_commands.bzl | 3 ++-
 3 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/BUILD b/BUILD
index e120f11..4470829 100644
--- a/BUILD
+++ b/BUILD
@@ -1,4 +1,5 @@
 load(":refresh_compile_commands.bzl", "refresh_compile_commands")
+load("@rules_cc//cc:defs.bzl", "cc_binary")
 
 # See README.md for interface.
 
diff --git a/MODULE.bazel b/MODULE.bazel
index 23e060f..698fcf7 100644
--- a/MODULE.bazel
+++ b/MODULE.bazel
@@ -1,5 +1,8 @@
 module(name = "hedron_compile_commands")
 
+bazel_dep(name = "rules_cc", version = "0.2.16")
+bazel_dep(name = "rules_python", version = "1.8.3")
+
 p = use_extension("//:workspace_setup.bzl", "hedron_compile_commands_extension")
 pt = use_extension("//:workspace_setup_transitive.bzl", "hedron_compile_commands_extension")
 ptt = use_extension("//:workspace_setup_transitive_transitive.bzl", "hedron_compile_commands_extension")
diff --git a/refresh_compile_commands.bzl b/refresh_compile_commands.bzl
index 0210d42..f86e533 100644
--- a/refresh_compile_commands.bzl
+++ b/refresh_compile_commands.bzl
@@ -57,6 +57,7 @@ refresh_compile_commands(
 # Implementation
 
 load("@bazel_tools//tools/cpp:toolchain_utils.bzl", "find_cpp_toolchain")
+load("@rules_python//python:defs.bzl", "py_binary")
 
 
 def refresh_compile_commands(
@@ -92,7 +93,7 @@ def refresh_compile_commands(
     _expand_template(name = script_name, labels_to_flags = targets, exclude_headers = exclude_headers, exclude_external_sources = exclude_external_sources, **kwargs)
 
     # Combine them so the wrapper calls the main script
-    native.py_binary(
+    py_binary(
         name = name,
         main = version_checker_script_name,
         srcs = [version_checker_script_name, script_name],
-- 
2.52.0

