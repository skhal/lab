--- /usr/local/etc/openldap/slapd.ldif.sample	2025-12-03 23:53:20.000000000 -0600
+++ /usr/local/etc/openldap/slapd.ldif	2025-12-18 13:37:23.305268000 -0600
@@ -21,6 +21,12 @@
 #	Require 112-bit (3DES or better) encryption for updates
 #	Require 64-bit encryption for simple bind
 #olcSecurity: ssf=1 update_ssf=112 simple_bind=64
+olcSecurity: ssf=128
+olcTLSCertificateFile: /usr/local/share/ssl/certs/ldap.crt
+olcTLSCertificateKeyFile: /usr/local/share/ssl/private/ldap.key
+olcTLSCACertificateFile: /usr/local/share/certs/ca.crt
+olcTLSProtocolMin: 3.1
+olcTLSVerifyClient: never
 
 
 #
@@ -39,6 +45,8 @@
 cn: schema
 
 include: file:///usr/local/etc/openldap/schema/core.ldif
+include: file:///usr/local/etc/openldap/schema/cosine.ldif
+include: file:///usr/local/etc/openldap/schema/nis.ldif
 
 # Frontend settings
 #
@@ -69,6 +77,12 @@
 # rootdn can always read and write EVERYTHING!
 #
 
+dn: olcDatabase=config,cn=config
+objectClass: olcDatabaseConfig
+olcDatabase: config
+olcAccess: to *
+  by dn.exact=gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth manage
+  by * none
 
 #######################################################################
 # LMDB database definitions
@@ -79,18 +93,29 @@
 objectClass: olcMdbConfig
 olcDatabase: mdb
 olcDbMaxSize: 1073741824
-olcSuffix: dc=my-domain,dc=com
-olcRootDN: cn=Manager,dc=my-domain,dc=com
+olcSuffix: dc=lab,dc=net
+olcRootDN: cn=op,dc=lab,dc=net
 # Cleartext passwords, especially for the rootdn, should
 # be avoided.  See slappasswd(8) and slapd-config(5) for details.
 # Use of strong authentication encouraged.
-olcRootPW: secret
+olcRootPW: {SSHA}***REDACTED***
 # The database directory MUST exist prior to running slapd AND 
 # should only be accessible by the slapd and slap tools.
 # Mode 700 recommended.
-olcDbDirectory:	/var/db/openldap-data
+olcDbDirectory:  /var/db/openldap-data/lab.net
 # Indices to maintain
 olcDbIndex: objectClass eq
+olcDbIndex: uid pres,eq
+olcDbIndex: cn,sn pres,eq,approx,sub
+olcAccess: to attrs=userPassword
+  by self write
+  by anonymous auth
+  by dn.base="cn=op,dc=lab,dc=net" write
+  by * none
+olcAccess: to *
+  by self write
+  by dn.base="cn=op,dc=lab,dc=net" write
+  by * read
 
 dn: olcDatabase=monitor,cn=config
 objectClass: olcDatabaseConfig
